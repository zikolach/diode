<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Usage with React | Diode</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-prism/prism.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    
    <link rel="prev" href="./advanced/ActionProcessors.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="3" data-chapter-title="Usage with React" data-filepath="UsageWithReact.md" data-basepath="." data-revision="Mon Nov 30 2015 14:42:05 GMT+0200 (FLE Standard Time)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="usage/index.html">
            
                
                    <a href="./usage/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Usage
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="usage/ApplicationModel.html">
            
                
                    <a href="./usage/ApplicationModel.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Application Model
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="usage/Actions.html">
            
                
                    <a href="./usage/Actions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="usage/Handlers.html">
            
                
                    <a href="./usage/Handlers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Action Handlers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="usage/Views.html">
            
                
                    <a href="./usage/Views.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Views
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="usage/Effects.html">
            
                
                    <a href="./usage/Effects.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Async Effects
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="advanced/index.html">
            
                
                    <a href="./advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Advanced Topics
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="advanced/Pot.html">
            
                
                    <a href="./advanced/Pot.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Async Model Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="advanced/PotActions.html">
            
                
                    <a href="./advanced/PotActions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Stateful Actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="advanced/ActionProcessors.html">
            
                
                    <a href="./advanced/ActionProcessors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Action Processors
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="3" data-path="UsageWithReact.html">
            
                
                    <a href="./UsageWithReact.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Usage with React
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Diode</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="usage-with-react">Usage with React</h1>
<p>Although Diode is totally framework agnostic, it does work very well together with <a href="https://facebook.github.io/react/" target="_blank">React</a>. To simplify integration of Diode
with your <a href="https://github.com/japgolly/scalajs-react" target="_blank">scalajs-react</a> application, use a separate library <code>diode-react</code>.</p>
<p>To use Diode React in your application add following dependency declaration to your Scala.js project.</p>
<pre><code class="lang-scala"><span class="token string">&quot;me.chrons&quot;</span> <span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span> <span class="token string">&quot;diode-react&quot;</span> <span class="token operator">%</span> <span class="token string">&quot;0.1.0&quot;</span></code></pre>

<h2 id="overview">Overview</h2>
<p>In React the user interface is build out of a hierarchy of <em>components</em>, each receiving <em>props</em> and optionally having internal <em>state</em>. With Diode you&apos;ll want
most of your React components to be <em>stateless</em> because state is managed by the Diode circuit. Sometimes, however, it is useful to maintain some state in the
UI component, for example when editing an item.</p>
<p>A very simple integration can be achieved just by passing a value from a <em>model reader</em> to your React component in its props. This works well for dummy <em>leaf</em>
components that just display data. This approach, however, has a few downsides:</p>
<ol>
<li>Your component is not notified of any model changes</li>
<li>Your component cannot dispatch any actions</li>
</ol>
<h2 id="wrap-and-connect-components">Wrap and Connect Components</h2>
<p>To simplify connecting your Diode circuit to your React components, Diode React provides a way to <em>wrap</em> and <em>connect</em> components. First step is to add the
<code>ReactConnector</code> trait to your application <code>Circuit</code> class.</p>
<pre><code class="lang-scala"><span class="token keyword">case</span> <span class="token keyword">class</span> RootModel<span class="token punctuation">(</span>data<span class="token operator">:</span> Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> asyncData<span class="token operator">:</span> Pot<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">object</span> AppCircuit <span class="token keyword">extends</span> Circuit<span class="token punctuation">[</span>RootModel<span class="token punctuation">]</span> <span class="token keyword">with</span> ReactConnector<span class="token punctuation">[</span>RootModel<span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre>
<p>Now your <code>AppCircuit</code> is equipped with two new methods: <code>wrap</code> and <code>connect</code>. Both methods have almost the same signature, taking a zoom function (or
alternatively a model reader) and a function to build a React component.</p>
<pre><code class="lang-scala"><span class="token keyword">def</span> wrap<span class="token punctuation">[</span>S<span class="token punctuation">,</span> C<span class="token punctuation">]</span><span class="token punctuation">(</span>zoomFunc<span class="token operator">:</span> M <span class="token keyword">=&gt;</span> S<span class="token punctuation">)</span><span class="token punctuation">(</span>compB<span class="token operator">:</span> ModelProxy<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token keyword">=&gt;</span> C<span class="token punctuation">)</span>
<span class="token keyword">def</span> connect<span class="token punctuation">[</span>S<span class="token punctuation">,</span> C<span class="token punctuation">]</span><span class="token punctuation">(</span>zoomFunc<span class="token operator">:</span> M <span class="token keyword">=&gt;</span> S<span class="token punctuation">)</span><span class="token punctuation">(</span>compB<span class="token operator">:</span> ModelProxy<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token keyword">=&gt;</span> C<span class="token punctuation">)</span>
</code></pre>
<p>The difference between these two is that <code>wrap</code> just creates a <code>ModelProxy</code> and passes it to your component builder function, while <code>connect</code> actually creates
another React component that surrounds your own component.</p>
<blockquote>
<p>Use <code>wrap</code> when your component doesn&apos;t need model updates from Diode, and <code>connect</code> when it does. Even if you use <code>wrap</code> on a top component, you can still
<code>connect</code> components underneath it.</p>
</blockquote>
<p>When wrapping or connecting a component, you can either pass the <code>ModelProxy</code> directly as props, or use it in the builder function to pass relevant props to
your component.</p>
<pre><code class="lang-scala"><span class="token comment" spellcheck="true">// connect with ModelProxy</span>
<span class="token keyword">val</span> smartComponent <span class="token operator">=</span> ReactComponentB<span class="token punctuation">[</span>ModelProxy<span class="token punctuation">[</span>Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;SmartComponent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>build
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">val</span> sc <span class="token operator">=</span> AppCircuit<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>_<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">(</span>p <span class="token keyword">=&gt;</span> smartComponent<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// wrap with specific props</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> Props<span class="token punctuation">(</span>data<span class="token operator">:</span> Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> onClick<span class="token operator">:</span> Callback<span class="token punctuation">)</span>
<span class="token keyword">val</span> dummyComponent <span class="token operator">=</span> ReactComponentB<span class="token punctuation">[</span>Props<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;DummyComponent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>build
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">val</span> dc <span class="token operator">=</span> AppCircuit<span class="token punctuation">.</span>wrap<span class="token punctuation">(</span>_<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">(</span>p <span class="token keyword">=&gt;</span> dummyComponent<span class="token punctuation">(</span>Props<span class="token punctuation">(</span>p<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>dispatch<span class="token punctuation">(</span>DummyClicked<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> render <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span>div<span class="token punctuation">(</span>sc<span class="token punctuation">,</span> dc<span class="token punctuation">)</span>
</code></pre>
<p>The <code>ModelProxy</code> provides a <code>dispatch</code> function that wraps the dispatch call in a React <code>Callback</code>, making it easy to integrate with event
handlers etc. It also provides <code>wrap</code> and <code>connect</code>, allowing your component to connect sub-components to the Diode circuit.</p>
<pre><code class="lang-scala"><span class="token keyword">val</span> Dashboard <span class="token operator">=</span> ReactComponentB<span class="token punctuation">[</span>ModelProxy<span class="token punctuation">[</span>RootModel<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;Dashboard&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>render_P <span class="token punctuation">{</span> proxy <span class="token keyword">=&gt;</span>
    <span class="token operator">&lt;</span><span class="token punctuation">.</span>div<span class="token punctuation">(</span>
      h3<span class="token punctuation">(</span><span class="token string">&quot;Data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      proxy<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>_<span class="token punctuation">.</span>asyncData<span class="token punctuation">)</span><span class="token punctuation">(</span>p <span class="token keyword">=&gt;</span> AsyncDataView<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// pass ModelProxy</span>
      proxy<span class="token punctuation">.</span>wrap<span class="token punctuation">(</span>_<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">(</span>p <span class="token keyword">=&gt;</span> DataView<span class="token punctuation">(</span>p<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// just pass the value</span>
      <span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">.</span>onClick <span class="token operator">--</span><span class="token operator">&gt;</span> proxy<span class="token punctuation">.</span>dispatch<span class="token punctuation">(</span>RefreshData<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Refresh&quot;</span><span class="token punctuation">)</span> 
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span>build
</code></pre>
<h2 id="rendering-pot">Rendering <code>Pot</code></h2>
<p>Because a <code>Pot</code> can exist in many states, it&apos;s desirable to reflect these states in your view components. Diode React extends <code>Pot</code> by adding convenient
rendering methods through <code>ReactPot</code>.</p>
<pre><code class="lang-scala"><span class="token comment" spellcheck="true">// use import to get access to implicit extension methods</span>
<span class="token keyword">import</span> diode<span class="token punctuation">.</span>react<span class="token punctuation">.</span>ReactPot<span class="token punctuation">.</span>_
</code></pre>
<p>An example from the <a href="https://github.com/ochrons/scalajs-spa-tutorial" target="_blank">SPA tutorial</a></p>
<pre><code class="lang-scala"><span class="token keyword">val</span> Motd <span class="token operator">=</span> ReactComponentB<span class="token punctuation">[</span>ModelProxy<span class="token punctuation">[</span>Pot<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;Motd&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>render_P <span class="token punctuation">{</span> proxy <span class="token keyword">=&gt;</span>
    Panel<span class="token punctuation">(</span>Panel<span class="token punctuation">.</span>Props<span class="token punctuation">(</span><span class="token string">&quot;Message of the day&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// render messages depending on the state of the Pot</span>
      proxy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>renderPending<span class="token punctuation">(</span>_ <span class="token operator">&gt;</span> <span class="token number">500</span><span class="token punctuation">,</span> _ <span class="token keyword">=&gt;</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span>p<span class="token punctuation">(</span><span class="token string">&quot;Loading...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      proxy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>renderFailed<span class="token punctuation">(</span>ex <span class="token keyword">=&gt;</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span>p<span class="token punctuation">(</span><span class="token string">&quot;Failed to load&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      proxy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span>m <span class="token keyword">=&gt;</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span>p<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      Button<span class="token punctuation">(</span>Button<span class="token punctuation">.</span>Props<span class="token punctuation">(</span>proxy<span class="token punctuation">.</span>dispatch<span class="token punctuation">(</span>UpdateMotd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CommonStyle<span class="token punctuation">.</span>danger<span class="token punctuation">)</span><span class="token punctuation">,</span> Icon<span class="token punctuation">.</span>refresh<span class="token punctuation">,</span> <span class="token string">&quot; Update&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre>
<p>Each of the rendering functions optionally renders the provided content, depending on the state of <code>Pot</code>. In <code>renderPending</code> you can supply a condition based
on the duration of the pending request, so that the UI will show a &quot;Loading&quot; message only after some time has elapsed. This of course requires that your action
is updating the model at suitable intervals for the model to update.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./advanced/ActionProcessors.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Action Processors"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-editlink/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"editlink":{"base":"https://github.com/ochrons/diode/tree/master/doc","label":"Edit This Page","multilingual":false},"github":{"url":"https://github.com/ochrons/diode/"},"prism":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
